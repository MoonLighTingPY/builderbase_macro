THINK REALLY GOOD AND DONT HALLUCINATE AND DONT SKIP ANYTHING. IF SOMETHING IS BROKEN - GIVE ME A FULL FIX, WITH ALL THE UPDATES IN ALL RELATED FILES, NO SKIPS, TODOS, AND PLACEHOLDERS.